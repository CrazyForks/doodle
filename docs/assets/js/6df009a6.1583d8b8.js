"use strict";(self.webpackChunkdoodle_docs=self.webpackChunkdoodle_docs||[]).push([[53],{1281:function(e,n,t){t.r(n),t.d(n,{assets:function(){return h},contentTitle:function(){return p},default:function(){return v},frontMatter:function(){return c},metadata:function(){return m},toc:function(){return k}});var a=t(3117),i=t(102),o=(t(7294),t(3905)),r=t(9877),l=t(8215),d=t(3138),s=["components"],c={hide_title:!0},p="Overview",m={unversionedId:"rendering/overview",id:"rendering/overview",title:"Overview",description:"Rendering is managed entirely by Views. Each View draws its content to the screen via the render",source:"@site/docs/rendering/overview.mdx",sourceDirName:"rendering",slug:"/rendering/overview",permalink:"/doodle/docs/rendering/overview",tags:[],version:"current",frontMatter:{hide_title:!0},sidebar:"tutorialSidebar",previous:{title:"Transformations",permalink:"/doodle/docs/transforms"},next:{title:"Text",permalink:"/doodle/docs/rendering/text"}},h={},k=[{value:"Efficient Rendering",id:"efficient-rendering",level:2},{value:"The Canvas",id:"the-canvas",level:2},{value:"Transforms",id:"transforms",level:3},{value:"Pattern Paints",id:"pattern-paints",level:3}],u={toc:k};function v(e){var n=e.components,t=(0,i.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"overview"},"Overview"),(0,o.kt)("p",null,"Rendering is managed entirely by Views. Each View draws its content to the screen via the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/core/View.kt#L484"},(0,o.kt)("inlineCode",{parentName:"a"},"render")),"\nmethod. Doodle calls this method whenever a View needs a visual update. And it is the simplest way to customize the way a View looks."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"class RectView: View() {\n    override fun render(canvas: Canvas) {\n        canvas.rect(bounds.atOrigin, Blue.paint)\n    }\n}\n")),(0,o.kt)("p",null,"This ",(0,o.kt)("inlineCode",{parentName:"p"},"RectView")," draws a filled rectangle covering its bounds. The ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/ColorPaint.kt#L32"},(0,o.kt)("inlineCode",{parentName:"a"},"paint")),"\nextension on ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/Color.kt#L12"},(0,o.kt)("inlineCode",{parentName:"a"},"Color")),"\ncreates a new ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/ColorPaint.kt#L5"},(0,o.kt)("inlineCode",{parentName:"a"},"ColorPaint")),"."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"render")," is automatically called on ",(0,o.kt)("inlineCode",{parentName:"p"},"size")," changes and ",(0,o.kt)("inlineCode",{parentName:"p"},"visible")," changing to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")))),(0,o.kt)("h2",{id:"efficient-rendering"},"Efficient Rendering"),(0,o.kt)("p",null,"Doodle optimizes rendering to avoid re-applying operations when rendering the same content repeatedly. For example, the ",(0,o.kt)("inlineCode",{parentName:"p"},"Timer")," app\nbelow renders the epoch time every millisecond. However, Doodle only updates the changing regions (i.e. the DOM for Web apps). The text in this case."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Doodle uses ",(0,o.kt)("a",{parentName:"p",href:"https://nacular.github.io/measured/"},"Measured")," for time, angles etc."))),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"demo",label:"Demo",mdxType:"TabItem"},(0,o.kt)(d.B,{functionName:"timer",height:"200",mdxType:"DoodleCodeBlock"})),(0,o.kt)(l.Z,{value:"code1",label:"View DSL",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'class Timer(display: Display, clock: Clock, scheduler: Scheduler): Application {\n    init {\n        display += view {\n            size = Size(200)\n\n            scheduler.every(1 * milliseconds) {\n                rerender()\n            }\n\n            render = {\n                rect(bounds.atOrigin, Stroke(Red))\n                text("${clock.epoch}", color = Black)\n                rect(bounds.at(y = 20.0), color = Green)\n            }\n        }\n    }\n\n    override fun shutdown() {}\n}\n'))),(0,o.kt)(l.Z,{value:"code2",label:"Render Property",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'class Timer(display: Display, clock: Clock, scheduler: Scheduler): Application {\n    init {\n        display += object: View() {\n            private var time by renderProperty(clock.epoch)\n\n            init {\n                size = Size(200)\n\n                scheduler.every(1 * milliseconds) {\n                    time = clock.epoch\n                }\n            }\n\n            override fun render(canvas: Canvas) {\n                canvas.rect(bounds.atOrigin, Stroke(Red))\n                canvas.text("$time", color = Black)\n                canvas.rect(bounds.at(y = 20.0), color = Green)\n            }\n        }\n    }\n\n    override fun shutdown() {}\n}\n')))),(0,o.kt)("h2",{id:"the-canvas"},"The Canvas"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"render")," method provides a ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/Canvas.kt#L24"},(0,o.kt)("inlineCode",{parentName:"a"},"Canvas")),"\nonto which a ",(0,o.kt)("inlineCode",{parentName:"p"},"View")," can draw. Canvas offers a rich set of operations for geometric shapes, paths, images, and text. It\nalso supports different ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/Paint.kt#L4"},(0,o.kt)("inlineCode",{parentName:"a"},"Paint")),"\ntypes (i.e. ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/ColorPaint.kt#L5"},(0,o.kt)("inlineCode",{parentName:"a"},"ColorPaint")),",\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/LinearGradientPaint.kt#L31"},(0,o.kt)("inlineCode",{parentName:"a"},"LinearGradientPaint")),", and\n",(0,o.kt)("a",{parentName:"p",href:"/doodle/docs/rendering/overview#pattern-paints"},"PatternPaint"),") for filling regions."),(0,o.kt)("p",null,"The Canvas provided to ",(0,o.kt)("inlineCode",{parentName:"p"},"render")," has a coordinate system anchored to the View's origin, so ",(0,o.kt)("inlineCode",{parentName:"p"},"0,0")," on the View and Canvas are the same point.\nThe Canvas itself extends in all directions beyond the bounds of the View; but the contents drawn to it will be clipped to the view's\nbounds by default."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Sub-classes can disable clipping by setting ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/core/View.kt#L123"},(0,o.kt)("inlineCode",{parentName:"a"},"clipCanvasToBounds")),"\nto ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),"."))),(0,o.kt)("h3",{id:"transforms"},"Transforms"),(0,o.kt)("p",null,"The canvas can also be transformed using any ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/AffineTransform.kt#L16"},(0,o.kt)("inlineCode",{parentName:"a"},"AffineTransform")),".\nTransforms can also be nested to create combined effects to. Here, the view flips the Canvas horizontally around its mid-point and draws some text."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'class MyView: View() {\n    override fun render(canvas: Canvas) {\n        canvas.flipHorizontally(around = width / 2) {\n            text("hello", color = Black)\n        }\n    }\n}\n')),(0,o.kt)("h3",{id:"pattern-paints"},"Pattern Paints"),(0,o.kt)("p",null,"Sometimes you need to fill a region with a repeating pattern, like an image or some geometric shapes. Doodle has the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/PatternPaint.kt#L13"},(0,o.kt)("inlineCode",{parentName:"a"},"PatternPaint")),' to make this easy.\nThis paint has a "render" body that provides a powerful and familiar way of creating repeating patterns.'),(0,o.kt)("p",null,"You create this paint by specifying a ",(0,o.kt)("inlineCode",{parentName:"p"},"size")," and a ",(0,o.kt)("inlineCode",{parentName:"p"},"paint")," lambda, which has access to the full ",(0,o.kt)("inlineCode",{parentName:"p"},"Canvas")," APIs."),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"demo",label:"Demo",mdxType:"TabItem"},(0,o.kt)(d.B,{functionName:"patternPaint",height:"300",mdxType:"DoodleCodeBlock"})),(0,o.kt)(l.Z,{value:"code",label:"Code",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:"title=io.nacular.doodle.drawing.PatternPaint.kt",title:"io.nacular.doodle.drawing.PatternPaint.kt"},"fun stripedPaint(stripeWidth : Double,\n                 evenRowColor: Color? = null,\n                 oddRowColor : Color? = null,\n                 transform   : AffineTransform2D = Identity) =\nPatternPaint(Size(if (evenRowColor.visible || oddRowColor.visible) stripeWidth else 0.0, 2 * stripeWidth), transform) {\n    evenRowColor?.paint?.let { rect(Rectangle(                  stripeWidth, stripeWidth), it) }\n    oddRowColor?.paint?.let  { rect(Rectangle(0.0, stripeWidth, stripeWidth, stripeWidth), it) }\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},"class MyView: View() {\n    val stripeWidth = 20.0\n    var paintAngle by renderProperty(0 * degrees)\n\n    override fun render(canvas: Canvas) {\n        val paintCenter = Point(canvas.size.width / 2, canvas.size.height / 2)\n\n        canvas.rect(bounds.atOrigin, stripedPaint(\n                stripeWidth  = stripeWidth,\n                evenRowColor = Red,\n                oddRowColor  = White,\n                transform    = Identity.rotate(around = paintCenter, by = paintAngle)\n        ))\n    }\n}\n")))),(0,o.kt)("p",null,"This app shows how a ",(0,o.kt)("inlineCode",{parentName:"p"},"PatternPaint")," can be transformed using ",(0,o.kt)("inlineCode",{parentName:"p"},"PatternTransform"),", like rotated around its center for example."))}v.isMDXComponent=!0}}]);