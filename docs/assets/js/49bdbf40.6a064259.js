"use strict";(self.webpackChunkdoodle_docs=self.webpackChunkdoodle_docs||[]).push([[1564],{2315:(e,n,o)=>{o.d(n,{A:()=>t});const t="package elementview\n\nimport io.nacular.doodle.HtmlElementViewFactory\nimport io.nacular.doodle.application.Application\nimport io.nacular.doodle.application.HtmlElementViewModule\nimport io.nacular.doodle.application.Modules\nimport io.nacular.doodle.application.application\nimport io.nacular.doodle.core.Display\nimport org.kodein.di.instance\nimport org.w3c.dom.HTMLElement\n\nprivate class MyApp(\n    display    : Display,\n    viewFactory: HtmlElementViewFactory,\n    element    : HTMLElement\n): Application {\n    init {\n        display += viewFactory(element)\n    }\n\n    override fun shutdown() {}\n}\n\nfun main(element: HTMLElement) {\n//sampleStart\n    application(modules = listOf(Modules.HtmlElementViewModule)) {\n         MyApp(display = instance(), viewFactory = instance(), element = element)\n    }\n//sampleEnd\n}\n"},2897:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>x,contentTitle:()=>b,default:()=>M,frontMatter:()=>f,metadata:()=>t,toc:()=>v});const t=JSON.parse('{"id":"platform_specific/web","title":"Web","description":"Host apps in HTML elements","source":"@site/docs/platform_specific/web.mdx","sourceDirName":"platform_specific","slug":"/platform_specific/web","permalink":"/doodle/docs/platform_specific/web","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"hide_title":true,"title":"Web"},"sidebar":"tutorialSidebar","previous":{"title":"Desktop","permalink":"/doodle/docs/platform_specific/desktop"}}');var i=o(4848),a=o(8453),l=o(5537),r=o(9329),p=o(7269),d=o(4069),s=o(7045),c=o(9172),h=o(4240),m=o(2315);const u="package io.nacular.doodle.docs.apps.nesting\n\nimport io.nacular.doodle.application.Application\nimport io.nacular.doodle.controls.ColorPicker\nimport io.nacular.doodle.core.Display\nimport io.nacular.doodle.docs.utils.doodleColor\nimport io.nacular.doodle.drawing.opacity\nimport io.nacular.doodle.layout.Insets\nimport io.nacular.doodle.layout.constraints.constrain\nimport io.nacular.doodle.layout.constraints.fill\n\n//sampleStart\nclass InnerApp(display: Display): Application {\n    init {\n        // Shows a color picker\n        display += ColorPicker(doodleColor opacity 0.75f).apply {\n            changed += { _,_,new -> println(new) }\n        }\n\n        // The picker grows with the display, but is inset a little\n        display.layout = constrain(display.first(), fill(insets = Insets(2.0)))\n    }\n\n    override fun shutdown() {}\n}\n//sampleEnd",y="package io.nacular.doodle.docs.apps.nesting\n\nimport io.nacular.doodle.application.Application\nimport io.nacular.doodle.application.ApplicationViewFactory\nimport io.nacular.doodle.application.Modules.Companion.PointerModule\nimport io.nacular.doodle.core.Display\nimport io.nacular.doodle.core.center\nimport io.nacular.doodle.core.height\nimport io.nacular.doodle.core.width\nimport io.nacular.doodle.drawing.Color.Companion.White\nimport io.nacular.doodle.drawing.paint\nimport io.nacular.doodle.geometry.Rectangle\nimport io.nacular.doodle.geometry.centered\nimport io.nacular.doodle.utils.Resizer\nimport org.kodein.di.instance\nimport kotlin.math.min\n\n//sampleStart\nclass OuterApp(display: Display, appView: ApplicationViewFactory): Application {\n    init {\n        // NOTE: Any module needed by InnerApp MUST be provided to the factory.\n        // PointerModule used here to enable interaction with the color picker.\n        display += appView(modules = listOf(PointerModule)) {\n            InnerApp(display = instance()) // Init inner app\n        }.apply {\n            suggestBounds(Rectangle(\n                min(400.0, display.width  - 20),\n                min(300.0, display.height - 20)\n            ).centered(at = display.center))\n\n            Resizer(this, movable = false)\n        }\n\n        display.fill(White.paint)\n    }\n\n    override fun shutdown() {}\n}\n//sampleEnd",g="package outerapp\n\nimport io.nacular.doodle.application.ApplicationViewFactory.Companion.AppViewModule\nimport io.nacular.doodle.application.Modules.Companion.PointerModule\nimport io.nacular.doodle.application.application\nimport io.nacular.doodle.docs.apps.nesting.OuterApp\nimport org.kodein.di.instance\n\nfun main() {\n//sampleStart\n    // NOTE: Modules used by the outer app are not available to the inner one.\n    // The PointerModule is used here to allow resizing of the View that holds the inner app.\n    application(modules = listOf(AppViewModule, PointerModule)) {\n        OuterApp(display = instance(), appView = instance())\n    }\n//sampleEnd\n}\n",w="package htmlelementapp\n\nimport UsefulApp\nimport io.nacular.doodle.application.application\nimport org.w3c.dom.HTMLElement\n\n//sampleStart\nfun main(element: HTMLElement) {\n    // launch app within element\n    application(element) {\n        UsefulApp()\n    }\n}\n//sampleEnd",f={hide_title:!0,title:"Web"},b="Web",x={},v=[{value:"Host apps in HTML elements",id:"host-apps-in-html-elements",level:2},{value:"Nested apps",id:"nested-apps",level:2},{value:"Host arbitrary HTML elements",id:"host-arbitrary-html-elements",level:2}];function A(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",strong:"strong",...(0,a.R)(),...e.components};return c.F||j("api",!1),c.F.AppViewModule||j("api.AppViewModule",!0),c.F.ApplicationViewFactory||j("api.ApplicationViewFactory",!0),c.F.View||j("api.View",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"web",children:"Web"})}),"\n",(0,i.jsx)(n.h2,{id:"host-apps-in-html-elements",children:"Host apps in HTML elements"}),"\n",(0,i.jsx)(n.p,{children:"You can also provide an HTML element when launching a top-level Web app. This allows you to host Doodle apps in non-Doodle contexts. The apps in this documentation are top-level within specific elements."}),"\n",(0,i.jsxs)(n.p,{children:["Closing the page cleans up any apps within it. Removing the element hosting an app or explicitly calling ",(0,i.jsx)(n.code,{children:"shutdown"})," has the same effect."]}),"\n",(0,i.jsx)(d.v,{children:w}),"\n",(0,i.jsx)(n.h2,{id:"nested-apps",children:"Nested apps"}),"\n",(0,i.jsxs)(n.p,{children:["Doodle Web apps can be run within other Doodle Web apps. This is done by placing the nested app in a ",(0,i.jsx)(n.a,{href:"/doodle/docs/views",children:(0,i.jsx)(n.strong,{children:"View"})})," that the host app manages. An app launched this way has the same functionality as a top-level one. Its lifecycle however, is tied to the host ",(0,i.jsx)(c.F.View,{}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["You simply use an ",(0,i.jsx)(c.F.ApplicationViewFactory,{})," (available via the ",(0,i.jsx)(c.F.AppViewModule,{}),") to create nested apps."]}),"\n",(0,i.jsx)(p.T,{functionName:"nestedApp",height:"400"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(r.A,{value:"Inner App",children:(0,i.jsx)(d.v,{children:u})}),(0,i.jsx)(r.A,{value:"Outer App",children:(0,i.jsx)(d.v,{children:y})}),(0,i.jsx)(r.A,{value:"Outer App Launcher",children:(0,i.jsx)(d.v,{children:g})})]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["Adding a nested app's View to the ",(0,i.jsx)(n.a,{href:"/doodle/docs/display",children:(0,i.jsx)(n.strong,{children:"Display"})})," triggers the app's initialization. Shutdown the app by removing the host View from the Display."]})}),"\n",(0,i.jsx)(n.h2,{id:"host-arbitrary-html-elements",children:"Host arbitrary HTML elements"}),"\n",(0,i.jsxs)(n.p,{children:["You can embed any HTML element into your app as a ",(0,i.jsx)(c.F.View,{}),". This means Doodle apps can host React and other web components and interop with a much larger part of the Web ecosystem out of the box!"]}),"\n",(0,i.jsx)(s.Z,{height:"400"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(r.A,{value:"App",children:(0,i.jsx)(d.v,{children:h.A})}),(0,i.jsx)(r.A,{value:"Example Launcher",children:(0,i.jsx)(d.v,{children:m.A})})]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["This app embeds a ",(0,i.jsx)(n.a,{href:"https://projects.wojtekmaj.pl/react-calendar/",children:"react-calendar"}),"."]})})]})}function M(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(A,{...e})}):A(e)}function j(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},4240:(e,n,o)=>{o.d(n,{A:()=>t});const t='package io.nacular.doodle.docs.apps\n\nimport io.nacular.doodle.HtmlElementViewFactory\nimport io.nacular.doodle.animation.Animator\nimport io.nacular.doodle.application.Application\nimport io.nacular.doodle.controls.text.Label\nimport io.nacular.doodle.core.Display\nimport io.nacular.doodle.docs.utils.DateRangeSelectionModel\nimport io.nacular.doodle.docs.utils.HorizontalCalendar\nimport io.nacular.doodle.docs.utils.ShadowCard\nimport io.nacular.doodle.drawing.Font\nimport io.nacular.doodle.geometry.PathMetrics\nimport io.nacular.doodle.layout.constraints.constrain\nimport io.nacular.doodle.theme.Theme\nimport io.nacular.doodle.theme.ThemeManager\nimport kotlinx.datetime.DatePeriod\nimport kotlinx.datetime.LocalDate\nimport kotlinx.datetime.plus\nimport org.w3c.dom.HTMLElement\n\nclass ReactCalendarApp(\n    display        : Display,\n    font           : Font,\n    today          : LocalDate,\n    animate        : Animator,\n    pathMetrics    : PathMetrics,\n    themeManager   : ThemeManager,\n    theme          : Theme,\n    htmlElementView: HtmlElementViewFactory,\n    reactCalendar  : HTMLElement,\n    appHeight      : (Double) -> Unit\n): Application {\n\n    private val doodleCalendar = HorizontalCalendar(\n        today          = today,\n        animate        = animate,\n        pathMetrics    = pathMetrics,\n        startDate      = today,\n        endDate        = today + DatePeriod(years = 10),\n        selectionModel = DateRangeSelectionModel()\n    ).apply {\n        this.font = font\n    }\n\n    init {\n        themeManager.selected = theme\n\n//sampleStart\n\n        display += Label("Doodle").apply { this.font = font }\n        display += Label("React" ).apply { this.font = font }\n        display += ShadowCard(doodleCalendar)\n        display += htmlElementView(element = reactCalendar)\n\n//sampleEnd\n\n        val spacing = 20\n\n        display.children.last().boundsChanged += { _,_,new ->\n            // signal to outer docs about height of the app\n            appHeight(display.children.maxOf { it.bounds.bottom } + spacing)\n        }\n\n        display.layout = constrain(\n            display.children[0],\n            display.children[1],\n            display.children[2],\n            display.children[3]\n        ) { doodleLabel, reactLabel, doodle, react ->\n\n            doodle.top          eq doodleLabel.bottom + spacing\n            doodle.height       eq 280\n\n            react.height        eq doodle.height\n\n            doodleLabel.top     eq spacing\n            doodleLabel.centerX eq doodle.centerX\n            doodleLabel.size.preserve\n\n            reactLabel.centerX  eq react.centerX\n            reactLabel.size.preserve\n\n            when {\n                parent.width.readOnly > 800 -> {\n                    doodle.width    eq (parent.width - 3 * spacing) / 2\n                    doodle.right    eq parent.centerX - spacing / 2\n                    react.top       eq doodle.top\n                    react.width     eq doodle.width\n                    react.left      eq doodle.right + spacing\n                    reactLabel.top  eq doodleLabel.top\n                }\n                else -> {\n                    doodle.left     eq spacing\n                    doodle.right    eq parent.right - spacing\n                    react.top       eq reactLabel.bottom + spacing\n                    react.left      eq spacing\n                    react.right     eq parent.right - spacing\n                    reactLabel.top  eq doodle.bottom + spacing\n                }\n            }\n        }\n    }\n\n    override fun shutdown() {\n        // no-op\n    }\n}'},7045:(e,n,o)=>{o.d(n,{Z:()=>d});var t=o(6540),i=o(3387),a=o.n(i),l=o(7528),r=o(8596),p=(o(7957),o(4848));class d extends t.Component{constructor(e){super(e),e.args&&(this.args=JSON.parse(e.args)),this.height=e.height,this.functionName="reactComponent",this.ref=t.createRef()}componentDidMount(){let e=this.ref.current.children[1];this.ref.current.removeChild(this.ref.current.children[1]),this.app=a()[this.functionName](this.ref.current.children[0],e)}componentWillUnmount(){this.app}render(){return(0,p.jsxs)("div",{className:l.A.doodle,ref:this.ref,children:[(0,p.jsx)("div",{style:{position:"relative",height:this.height+"px"}}),(0,p.jsx)(r.Ay,{})]})}}}}]);