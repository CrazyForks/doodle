"use strict";(self.webpackChunkdoodle_docs=self.webpackChunkdoodle_docs||[]).push([[325],{7825:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>m});var n=t(7462),i=(t(7294),t(3905)),o=(t(8209),t(5488),t(5162),t(4903));const r={hide_title:!0},s="Transformations",l={unversionedId:"transforms",id:"transforms",title:"Transformations",description:"Views are bound to a 2D grid when it comes to their layout. This grid only allows a View to have an x and y position, and an area within the plane.",source:"@site/docs/transforms.mdx",sourceDirName:".",slug:"/transforms",permalink:"/doodle/docs/transforms",draft:!1,tags:[],version:"current",frontMatter:{hide_title:!0},sidebar:"tutorialSidebar",previous:{title:"Constraints",permalink:"/doodle/docs/layout/constraints"},next:{title:"Overview",permalink:"/doodle/docs/rendering/overview"}},d={},m=[{value:"Affine Transforms",id:"affine-transforms",level:2},{value:"Identity Transform",id:"identity-transform",level:2},{value:"Cameras",id:"cameras",level:2},{value:"Sharing Cameras",id:"sharing-cameras",level:2},{value:"2-Sided Views",id:"2-sided-views",level:2}],p={toc:m};function h(e){let{components:a,...t}=e;return(0,i.kt)("wrapper",(0,n.Z)({},p,t,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"transformations"},"Transformations"),(0,i.kt)("p",null,"Views are bound to a 2D grid when it comes to their layout. This grid only allows a View to have an ",(0,i.kt)("inlineCode",{parentName:"p"},"x")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"y")," position, and an area within the plane.\nHowever, every View can also be transformed using ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Affine_transformation"},"Affine Transformations")," (and perspective)\nthat alter the way they are displayed. These transforms allow you to change a View's position and shape in the full 3D volume."),(0,i.kt)(o.l,{functionName:"playingCard",height:"500",mdxType:"DoodleApp"}),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Use the right slider to change the camera distance from the View, which changes the intensity of the perspective used to render it.")),(0,i.kt)("h2",{id:"affine-transforms"},"Affine Transforms"),(0,i.kt)("p",null,"Each View has a ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/core/View.kt#L244"},(0,i.kt)("inlineCode",{parentName:"a"},"transform")),"\nproperty that takes an ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/AffineTransform.kt#L27"},(0,i.kt)("inlineCode",{parentName:"a"},"AffineTransform")),".\nThis property can be set at any time to change how the View is rendered. Changes to this property will update the View on screen if it is visible.\nTransformations are very lightweight and do not require re-rendering or trigger layouts when modified. This makes them a great option for animations\nand other UI treatments."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"import io.nacular.doodle.drawing.AffineTransform.Companion.Identity\nimport io.nacular.measured.units.Angle.Companion.degrees\nimport io.nacular.measured.units.times\n\nview.transform = Identity\nview.transform = Identity.rotateX(around = view.center, by = 45 * degrees)\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"AffineTransform"),"s can also be combined to produce more complex operations. The end result is a single transform that will behave as though\neach operation were done in succession."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"transform.\n    rotateY(by = xRotation, around = center).\n    rotateX(by = yRotation, around = center).\n    //...\n    flipHorizontally()\n")),(0,i.kt)("h2",{id:"identity-transform"},"Identity Transform"),(0,i.kt)("p",null,"Views default to the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/drawing/AffineTransform.kt#L519"},(0,i.kt)("inlineCode",{parentName:"a"},"Identity")),"\ntransform, which does not change the View at all. Set this to effectively clear a View's transform."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"// Scale view by 2 in x and y\nview.transform = Identity.scale(2, 2)\n\n// ...\n\n// Remove all transform effects\nview.transform = Identity\n")),(0,i.kt)("h2",{id:"cameras"},"Cameras"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"AffineTransform"),"s warp an object while preserving collinearity (points on a line remain on a line) and distance ratios. This means they are insufficient\nto produce perspective. Perspective requires a transformation that preserves collinearity, but not distance ratios. Doodle supports this via\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/core/Camera.kt#L10"},(0,i.kt)("inlineCode",{parentName:"a"},"Camera")),"s.\nEach Camera has a ",(0,i.kt)("inlineCode",{parentName:"p"},"position")," (relative to a View's parent) and ",(0,i.kt)("inlineCode",{parentName:"p"},"distance"),", which define where vanishing points will be and the intensity their parallel\nwarping effect. Each View has a ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/nacular/doodle/blob/master/Core/src/commonMain/kotlin/io/nacular/doodle/core/View.kt#L252"},(0,i.kt)("inlineCode",{parentName:"a"},"camera")),"\nthat will combine with its ",(0,i.kt)("inlineCode",{parentName:"p"},"transform")," to produce a final perspective transformation."),(0,i.kt)(o.l,{functionName:"camera",height:"500",mdxType:"DoodleApp"}),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"Drag the camera to change its position. Resize it to change its distance from the plane.")),(0,i.kt)("h2",{id:"sharing-cameras"},"Sharing Cameras"),(0,i.kt)("p",null,"Views can share a single Camera, which allows them to share the same perspective when they have the same parent (or are all top-level).\nThe result, as you can see below is the effect of the Views sharing the same 3D space."),(0,i.kt)(o.l,{functionName:"camera2",height:"500",mdxType:"DoodleApp"}),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"A View's Camera position is relative to its parent, so shared Cameras only produce the single 3D space for Views with the ",(0,i.kt)("strong",{parentName:"p"},"same parent"),".")),(0,i.kt)("h2",{id:"2-sided-views"},"2-Sided Views"),(0,i.kt)("p",null,"Views render onto an infinitely flat plane that is similar to a sheet of glass. This means you see the contents of a View that is flipped or rotated as\nthough you are looking through the back of that pane of glass. You can have Views with 2-sides of course, as you see with the playing cards.\nBut that requires logic to decide when the View's back is visible. The playing card does this by recomputing its face direction whenever its\n",(0,i.kt)("inlineCode",{parentName:"p"},"transform")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"camera")," change, and repainting if needed."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-kotlin"},"// Example of how one might determine whether a View is facing the user.\n// This takes the cross product of 2 vectors on the View's surface and\n// applies its transformation and camera.\n\nval points = (camera.projection * transform).invoke(bounds.points.take(3))\nfaceUp = (points[1] - points[0] cross points[2] - points[1]).z > 0.0\n")))}h.isMDXComponent=!0}}]);