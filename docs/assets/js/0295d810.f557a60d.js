"use strict";(self.webpackChunkdoodle_docs=self.webpackChunkdoodle_docs||[]).push([[9812],{148:(e,n,i)=>{i.d(n,{SI:()=>s,cp:()=>h});var o=i(7624),a=i(4552),t=i(7793),l=i(6236),r=i(7492);const s=[];function d(e){const n={admonition:"admonition",p:"p",strong:"strong",...(0,a.M)(),...e.components};return(0,o.jsxs)(n.admonition,{title:"Library Required",type:"info",children:[(0,o.jsxs)("p",{children:["You will need to add the ",e.link," library to your app's dependencies."]}),(0,o.jsxs)(t.c,{groupId:"language",children:[(0,o.jsxs)(l.c,{value:"Kotlin",children:[(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"build.gradle.kts"})}),(0,o.jsx)(r.A,{children:e.kotlin})]}),(0,o.jsxs)(l.c,{value:"Groovy",children:[(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"build.gradle"})}),(0,o.jsx)(r.A,{children:e.groovy})]})]})]})}function h(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},5072:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>j,contentTitle:()=>B,default:()=>C,frontMatter:()=>f,metadata:()=>w,toc:()=>k});var o=i(7624),a=i(4552),t=i(7793),l=i(6236),r=i(148),s=i(5272),d=i(7492),h=i(3220);const c='dependencies {\n    implementation ("io.nacular.doodle:themes:$doodleVersion")\n}',m='//sampleStart\ndependencies {\n    implementation "io.nacular.doodle:themes:$doodle_version"\n}\n//sampleEnd',p="package themes\n\nimport io.nacular.doodle.core.View\nimport io.nacular.doodle.theme.Scene\nimport io.nacular.doodle.theme.Theme\n\n//sampleStart\nclass MyTheme: Theme {\n    override fun install(scene: Scene) {\n        //\n    }\n\n    override fun install(view: View) {\n        //\n    }\n}\n//sampleEnd",u="package themes\n\nimport io.nacular.doodle.application.Application\nimport io.nacular.doodle.application.application\nimport io.nacular.doodle.core.Display\nimport io.nacular.doodle.theme.Theme\nimport io.nacular.doodle.theme.ThemeManager\nimport io.nacular.doodle.theme.native.NativeTheme.Companion.NativeTheme\nimport org.kodein.di.instance\n\n//sampleStart\nclass SomeApp(display: Display, manager: ThemeManager, theme: Theme): Application {\n    init {\n        manager.selected = theme\n\n        // ...\n    }\n\n    override fun shutdown() {}\n}\n\nfun main() {\n    application(modules = listOf(NativeTheme)) {\n        SomeApp(display = instance(), manager = instance(), theme = instance())\n    }\n}\n//sampleEnd",v="package themes\n\nimport io.nacular.doodle.controls.ProgressBar\nimport io.nacular.doodle.controls.buttons.PushButton\nimport io.nacular.doodle.controls.range.Slider\nimport io.nacular.doodle.core.View\nimport io.nacular.doodle.theme.Scene\nimport io.nacular.doodle.theme.Theme\n\n//sampleStart\nclass NaiveTheme: Theme {\n    override fun install(scene: Scene) = scene.forEachView {\n        install(it)\n    }\n\n    override fun install(view: View) {\n        when (view) {\n            is Slider<*>   -> { /* it.behavior = ... */ }\n            is PushButton  -> { /* it.behavior = ... */ }\n            is ProgressBar -> { /* it.behavior = ... */ }\n            // ...\n        }\n    }\n}\n//sampleEnd",g="package themes\n\nimport io.nacular.doodle.application.Application\nimport io.nacular.doodle.controls.buttons.PushButton\nimport io.nacular.doodle.core.Display\nimport io.nacular.doodle.theme.Theme\nimport io.nacular.doodle.theme.ThemeManager\n\n//sampleStart\n/**\n * [NaiveTheme]'s static implementation leads to lots of dependencies that are\n * not used in [SimpleApp]. This includes the View and Behavior classes it uses.\n */\nclass SimpleApp(display: Display, manager: ThemeManager, theme: Theme): Application {\n    init {\n        manager.selected = theme\n\n        display += PushButton()\n    }\n\n    override fun shutdown() {}\n}\n//sampleEnd",T="package themes.dynamic\n\nimport io.nacular.doodle.application.application\nimport io.nacular.doodle.theme.native.NativeTheme.Companion.nativeButtonBehavior\nimport org.kodein.di.instance\nimport themes.SimpleApp\n\n//sampleStart\nfun main() {\n\n    // DynamicThemes require a list of Behavior modules since the\n    // Theme itself is essentially a Behavior filter.\n    // These modules are added to the list of app modules as follows\n\n    application(modules = listOf(nativeButtonBehavior(), /* other modules */)) {\n\n        // The nativeButtonBehavior module also makes ThemeManager and Theme\n        // available by default; so there's no need to use additional modules\n        // for them.\n\n        SimpleApp(display = instance(), manager = instance(), theme = instance())\n    }\n}\n//sampleEnd",b="package io.nacular.doodle.docs.apps\nimport io.nacular.doodle.application.Application\nimport io.nacular.doodle.controls.MultiSelectionModel\nimport io.nacular.doodle.controls.list.List\nimport io.nacular.doodle.controls.panels.ScrollPanel\nimport io.nacular.doodle.controls.toString\nimport io.nacular.doodle.core.Display\nimport io.nacular.doodle.core.center\nimport io.nacular.doodle.docs.utils.controlBackgroundColor\nimport io.nacular.doodle.docs.utils.highlightingTextVisualizer\nimport io.nacular.doodle.drawing.paint\nimport io.nacular.doodle.geometry.Rectangle\nimport io.nacular.doodle.geometry.Size\nimport io.nacular.doodle.geometry.centered\nimport io.nacular.doodle.layout.constraints.constrain\nimport io.nacular.doodle.theme.ThemeManager\nimport io.nacular.doodle.theme.ThemePicker\nimport io.nacular.doodle.theme.basic.BasicTheme\nimport io.nacular.doodle.theme.basic.DarkBasicTheme\nimport io.nacular.doodle.theme.native.NativeTheme\nimport io.nacular.doodle.theme.plus\nimport io.nacular.doodle.user.UserPreferences\nimport io.nacular.doodle.user.UserPreferences.ColorScheme\nimport io.nacular.doodle.user.UserPreferences.ColorScheme.Dark\nimport io.nacular.doodle.utils.Dimension.Height\nimport io.nacular.doodle.utils.Resizer\n\nclass ThemeApp(\n                display        : Display,\n    private val themeManager   : ThemeManager,\n                nativeTheme    : NativeTheme,\n                basicTheme     : BasicTheme,\n                basicDarkTheme : DarkBasicTheme,\n    private val userPreferences: UserPreferences\n): Application {\n    private val darkTheme   = nativeTheme + basicDarkTheme\n    private val lightTheme  = nativeTheme + basicTheme\n\n    // Monitor changes to the OS color scheme\n    private val colorSchemeChanged = { _: UserPreferences, _: ColorScheme, new: ColorScheme ->\n        themeManager.selected = when (new) {\n            Dark -> darkTheme\n            else -> lightTheme\n        }\n    }\n\n    private val themePicker = setupThemeControls()\n\n    private val list = List(\n        progression    = 1..1000,\n        itemVisualizer = toString(highlightingTextVisualizer()),\n        selectionModel = MultiSelectionModel(),\n        fitContent     = setOf(Height),\n    ).apply {\n        cellAlignment = {\n            it.left    eq 2\n            it.centerY eq parent.centerY\n        }\n    }\n\n    init {\n        display.children += themePicker\n        display.children += ScrollPanel(list).apply {\n            bounds                  = Rectangle(300, 200).centered(display.center)\n            contentWidthConstraints = { it eq this@apply.width - verticalScrollBarWidth }\n\n            Resizer(this).apply { movable = false }\n        }\n\n        display.layout = constrain(themePicker) {\n            it.top     eq parent.bottom - it.height.readOnly - 10\n            it.centerX eq parent.centerX\n        }\n\n        display.fill(controlBackgroundColor.paint)\n    }\n\n//sampleStart\n    private fun setupThemeControls(): ThemePicker {\n        userPreferences.colorSchemeChanged += colorSchemeChanged\n\n        themeManager.themes += setOf(lightTheme, darkTheme)\n\n        themeManager.selected = when (userPreferences.colorScheme) {\n            Dark -> darkTheme\n            else -> lightTheme\n        }\n\n        return ThemePicker(themeManager).apply { size = Size(280, 30) }\n    }\n//sampleEnd\n\n    override fun shutdown() {\n        userPreferences.colorSchemeChanged -= colorSchemeChanged\n    }\n}",y='package themes\n\nimport io.nacular.doodle.controls.IndexedItem\nimport io.nacular.doodle.controls.itemVisualizer\nimport io.nacular.doodle.controls.text.Label\nimport io.nacular.doodle.controls.theme.CommonLabelBehavior\nimport io.nacular.doodle.drawing.Color.Companion.White\nimport io.nacular.doodle.text.StyledText\nimport io.nacular.doodle.theme.Modules.Companion.bindBehavior\nimport io.nacular.doodle.theme.basic.BasicTheme.BasicThemeConfig\nimport io.nacular.doodle.theme.basic.BasicTheme.Companion.basicThemeModule\nimport io.nacular.doodle.utils.PropertyObservers\nimport io.nacular.doodle.utils.PropertyObserversImpl\nimport io.nacular.doodle.utils.observable\nimport org.kodein.di.instance\nimport io.nacular.doodle.theme.basic.BasicTheme as BasicThemeType\n\n//sampleStart\n/**\n * Visualizer that converts a String into a HighlightingLabel.\n */\nfun highlightingTextVisualizer() = itemVisualizer<String, IndexedItem> { item, previous, context ->\n    when (previous) {\n        is HighlightingLabel -> previous.apply {\n            text     = item\n            selected = context.selected\n        }\n        else                 -> HighlightingLabel(StyledText(item), context.selected)\n    }\n}\n\n/**\n * Simple Label that tracks whether it is selected.\n */\nclass HighlightingLabel(styledText: StyledText, selected: Boolean): Label(styledText) {\n    val selectedChanged: PropertyObservers<HighlightingLabel, Boolean> by lazy { PropertyObserversImpl(this) }\n\n    var selected by observable(selected, selectedChanged as PropertyObserversImpl)\n}\n\n/**\n * Custom module that installs a special Label Behavior into HighlightingLabels whenever the BasicTheme is selected.\n * This behavior ensures the foreground is White whenever the label is selected, and the theme default otherwise.\n */\nval highlightingLabelBehavior by lazy {\n    basicThemeModule(name = "HighlightingLabelBehavior") {\n        bindBehavior<HighlightingLabel>(BasicThemeType::class) { label ->\n            label.behavior = object: CommonLabelBehavior(textMetrics = instance()) {\n                private val selectedChanged = { _: HighlightingLabel, _: Boolean, _: Boolean ->\n                    label.foregroundColor = foregroundColor\n                }\n\n                override val foregroundColor get() = when {\n                    label.selected -> White\n                    else           -> instance<BasicThemeConfig>().foregroundColor\n                }\n\n                override fun install(view: Label) {\n                    super.install(view)\n                    label.selectedChanged += selectedChanged\n                }\n\n                override fun uninstall(view: Label) {\n                    label.selectedChanged -= selectedChanged\n                    super.uninstall(view)\n                }\n            }\n        }\n    }\n}\n//sampleEnd',x='package themes\n\nimport io.nacular.doodle.application.Modules.Companion.UserPreferencesModule\nimport io.nacular.doodle.application.application\nimport io.nacular.doodle.docs.apps.ThemeApp\nimport io.nacular.doodle.drawing.Color.Companion.Black\nimport io.nacular.doodle.theme.basic.BasicTheme.Companion.BasicTheme\nimport io.nacular.doodle.theme.basic.BasicTheme.Companion.basicButtonBehavior\nimport io.nacular.doodle.theme.basic.BasicTheme.Companion.basicLabelBehavior\nimport io.nacular.doodle.theme.basic.BasicTheme.Companion.basicListBehavior\nimport io.nacular.doodle.theme.basic.BasicTheme.Companion.basicSpinButtonBehavior\nimport io.nacular.doodle.theme.basic.DarkBasicTheme.Companion.DarkBasicTheme\nimport io.nacular.doodle.theme.native.NativeTheme.Companion.NativeTheme\nimport io.nacular.doodle.theme.native.NativeTheme.Companion.nativeScrollPanelBehavior\nimport org.kodein.di.instance\n\nfun launch() {\n//sampleStart\n    val appModules = listOf(\n        BasicTheme,\n        NativeTheme,\n        DarkBasicTheme,\n        UserPreferencesModule,\n        basicListBehavior(),\n        basicLabelBehavior(),\n        basicButtonBehavior(foregroundColor = Black, insets = 12.0),\n        basicSpinButtonBehavior(incrementA11yLabel = "Increment", decrementA11yLabel = "Decrement"),\n        highlightingLabelBehavior,\n        nativeScrollPanelBehavior(),\n    )\n\n    application(modules = appModules) {\n        ThemeApp(\n            display         = instance(),\n            basicTheme      = instance(),\n            nativeTheme     = instance(),\n            themeManager    = instance(),\n            basicDarkTheme  = instance(),\n            userPreferences = instance()\n        )\n    }\n//sampleEnd\n}\n',f={hide_title:!0,title:"Themes"},B=void 0,w={id:"themes",title:"Themes",description:"Themes",source:"@site/docs/themes.mdx",sourceDirName:".",slug:"/themes",permalink:"/doodle/docs/themes",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{hide_title:!0,title:"Themes"},sidebar:"tutorialSidebar",previous:{title:"Popups \u2022 Modals",permalink:"/doodle/docs/modals"},next:{title:"Catalog",permalink:"/doodle/docs/ui_components/overview"}},j={},k=[{value:"Themes",id:"themes",level:2},...r.SI,{value:"How themes work",id:"how-themes-work",level:2},{value:"ThemeManager",id:"thememanager",level:2},{value:"Bundle size",id:"bundle-size",level:2},{value:"Dynamic themes",id:"dynamic-themes",level:2}];function S(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",strong:"strong",...(0,a.M)(),...e.components};return h.m||M("api",!1),h.m.BasicTheme||M("api.BasicTheme",!0),h.m.BindBehavior||M("api.BindBehavior",!0),h.m.DynamicTheme||M("api.DynamicTheme",!0),h.m.NativeTheme||M("api.NativeTheme",!0),h.m.Theme||M("api.Theme",!0),h.m.ThemeManager||M("api.ThemeManager",!0),h.m.ThemeModule||M("api.ThemeModule",!0),h.m.ThemesLibrary||M("api.ThemesLibrary",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"themes",children:"Themes"}),"\n",(0,o.jsxs)(n.p,{children:["Doodle apps can use ",(0,o.jsx)(h.m.Theme,{}),"s to create a consistent look and behavior across their Views. Doodle has built-in support for a Native and Basic theme (which has a light and dark variant). The ",(0,o.jsx)(h.m.NativeTheme,{})," styles controls like buttons, text fields, and scroll panels using the system default styles and behaviors. The ",(0,o.jsx)(h.m.BasicTheme,{})," provides a customizable foundation to further build on."]}),"\n",(0,o.jsxs)(n.p,{children:["The following app shows a ",(0,o.jsx)(n.a,{href:"/doodle/docs/ui_components/overview#list",children:"List"})," of numbers that are visualized as custom ",(0,o.jsx)(n.a,{href:"ui_components/overview#label",children:"Labels"}),". These are all themed dynamically based on the ",(0,o.jsx)(n.strong,{children:"OS dark vs light setting"})," and the ",(0,o.jsx)(n.a,{href:"ui_components/overview#spinbutton",children:"SpinButton"})," control that manages which theme is selected."]}),"\n",(0,o.jsx)(s.u,{functionName:"themes",height:"400"}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsx)(n.p,{children:"Change the dark/light setting in your OS to see the app change in realtime."})}),"\n",(0,o.jsxs)(t.c,{children:[(0,o.jsx)(l.c,{value:"App",children:(0,o.jsx)(d.A,{children:b})}),(0,o.jsx)(l.c,{value:"Helpers",children:(0,o.jsx)(d.A,{children:y})}),(0,o.jsx)(l.c,{value:"Launcher",children:(0,o.jsx)(d.A,{children:x})})]}),"\n",(0,o.jsx)(r.cp,{link:(0,o.jsx)(h.m.ThemesLibrary,{}),kotlin:c,groovy:m}),"\n",(0,o.jsx)(n.h2,{id:"how-themes-work",children:"How themes work"}),"\n",(0,o.jsx)(n.p,{children:"Themes implement a simple interface that allows them to process the entire View graph and apply style and behavior changes. The API is as follows:"}),"\n",(0,o.jsx)(d.A,{children:p}),"\n",(0,o.jsxs)(n.p,{children:["Doodle calls the ",(0,o.jsx)(n.code,{children:"install"})," method when applying a Theme for the first time, and when Views are added to the Display after installation. It provides the ",(0,o.jsx)(n.code,{children:"Display"})," and a sequence of displayed Views. The Theme is free to customize both."]}),"\n",(0,o.jsx)(n.h2,{id:"thememanager",children:"ThemeManager"}),"\n",(0,o.jsxs)(n.p,{children:["Themes are handles by the ",(0,o.jsx)(h.m.ThemeManager,{}),". It provides an API for selecting the active Theme. Inject it into your app to work with Themes."]}),"\n",(0,o.jsx)(d.A,{children:u}),"\n",(0,o.jsxs)(n.p,{children:["This app installs the ",(0,o.jsx)(n.code,{children:"NativeTheme"}),", which is available in a bundle of the same name. That bundle also includes the common ",(0,o.jsx)(h.m.ThemeModule,{}),", which provides access to the ",(0,o.jsx)(n.code,{children:"ThemeManager"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"bundle-size",children:"Bundle size"}),"\n",(0,o.jsx)(n.p,{children:"Themes can lead to larger bundle sizes than expected depending on how they are implemented. Take the following\nfor example."}),"\n",(0,o.jsx)(d.A,{children:v}),"\n",(0,o.jsx)(n.admonition,{type:"danger",children:(0,o.jsx)(n.p,{children:"Themes defined this way are not very portable due to their heavy bundle cost"})}),"\n",(0,o.jsx)(d.A,{children:g}),"\n",(0,o.jsx)(n.h2,{id:"dynamic-themes",children:"Dynamic themes"}),"\n",(0,o.jsxs)(n.p,{children:["Doodle addresses this concern with the ",(0,o.jsx)(h.m.DynamicTheme,{}),". This Theme uses dependency injection to discover the set of Behaviors that have been installed via Kodein Modules. It can filter that list down to those Behaviors associated with it. This avoids hard dependencies on Views or Behaviors as a result."]}),"\n",(0,o.jsxs)(n.p,{children:["DynamicThemes require explicit Behavior registration to work. The built-in Themes define a Module per Behavior to allow arbitrary groupings within apps. These modules are defined using ",(0,o.jsx)(h.m.BindBehavior,{}),", which takes a ",(0,o.jsx)(h.m.Theme,{})," class and binds a ",(0,o.jsx)(h.m.DynamicTheme,{})," that includes behaviors associated with that class."]}),"\n",(0,o.jsx)(d.A,{children:T}),"\n",(0,o.jsxs)(n.p,{children:["This app no longer has extraneous dependencies on things like ",(0,o.jsx)(n.code,{children:"ProgressBar"})," and its ",(0,o.jsx)(n.code,{children:"Behavior"}),"."]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["Include behavior modules like this so they can be used as part of a dynamic ",(0,o.jsx)(n.code,{children:"Theme"}),"."]})})]})}function C(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(S,{...e})}):S(e)}function M(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);