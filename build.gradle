buildscript {
    ext.kotlin_version = '1.2.10'

    repositories {
        mavenCentral()
    }

    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
}

subprojects {
    apply plugin: 'idea'
    apply plugin: 'maven'
    apply plugin: 'kotlin2js'

    version = '1.0'
    group   = 'com.nectar.doodle'

    sourceSets {
        main.kotlin.srcDirs    += "src/main/headers"
        main.resources.srcDirs += "resources"

        test.kotlin.srcDirs    += "src/test/headers"
    }

    compileKotlin2Js {
        kotlinOptions.metaInfo              = true
        kotlinOptions.sourceMap             = true
        kotlinOptions.moduleKind            = "commonjs"
        kotlinOptions.sourceMapEmbedSources = "always"
    }

    compileTestKotlin2Js {
        kotlinOptions.metaInfo              = true
        kotlinOptions.sourceMap             = true
        kotlinOptions.moduleKind            = 'commonjs'
        kotlinOptions.sourceMapEmbedSources = "always"
    }

    dependencies {
        repositories {
            mavenCentral()
        }

        compile "org.jetbrains.kotlin:kotlin-stdlib-js:$kotlin_version"
    }
}